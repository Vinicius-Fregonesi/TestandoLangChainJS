<h1 class="mx-auto mt-4 text-light">Chat de Compras</h1>
<div class="chat-wrapper">
  <div class="chat-container card w-100 w-md-75 mx-auto shadow-lg rounded-4 border-0">
    <div class="card-body d-flex flex-column p-0 h-100">

        
      <div class="conversa">
        <div *ngFor="let msg of chatService.messages$ | async" class="mb-3">
          <div [ngClass]="{'text-end': msg.sender === 'user', 'text-start': msg.sender === 'bot'}">
            <div class="d-inline-block px-3 py-2 rounded-3" [ngClass]="{
              'user-msg': msg.sender === 'user',
              'bot-msg': msg.sender === 'bot'
            }">
              <div [innerHTML]="formatStructuredResponse(msg.content)"></div>


            </div>
          </div>
        </div>

        <div *ngIf="isTyping" class="text-start">
          <div class="d-inline-block px-3 py-2 rounded-3 bot-msg typing-indicator">
            <small><em>Bot est√° digitando...</em></small>
          </div>
        </div>
      </div>

      <!-- Campo de entrada -->
      <div class="input-group align-items-center gap-2">
        <input [(ngModel)]="userInput" type="text"
               class="form-control chat-input flex-grow-1"
               placeholder="Digite sua mensagem..."
               aria-label="Campo de mensagem"
               (keyup.enter)="sendMessage()" />

        <button class="btn btn-send"
                type="button"
                (click)="sendMessage()"
                [disabled]="!userInput.trim()"
                aria-label="Enviar mensagem">
          <i class="bi bi-send-fill me-1"></i> Enviar
        </button>
      </div>

    </div>
  </div>
</div>
